# 抽象语法树

当源代码被当做字符串拆解为token序列之后，词法解析器的任务就完成了。下一步需要进行语法分析，也就是从上一步得到的token序列生成ast抽象语法树。

### ast的节点类型

ast抽象语法树，树上的节点有表达式节点、也有语句节点。语句就是token按照一定的规则（语法）组成的句子。

### 如何构建

## 程序语言的语法描述

怎么把语法 用简单的数学符号表示出来。
假设 $ \Sigma $ 是一个字母表，其中字母的数量是有限的。定义从 $\Sigma$ 中取 $n$ 次符号 $ \left(n>0\right)$，依次拼成的串，叫字母表上的字符串，这个字母表能组成很多的字符串，特别地，当 $n = 0$ 时得到的字符串称为空串，计为 $ \varepsilon $ 。

一个字母表或者符号集合上，能有多少种字符串？答案是无穷种。
这个无穷集合记为 $\Sigma^*$ 。
例如 $\Sigma = \left\{a, b\right\}$ ，则对应的无穷集合 $\Sigma^* = \left\{\varepsilon, a,b,aa,bb,ab, aaa, bbb, aab, aba ...\right\}$ 。
如果一个字母表（符号集合）本身就是空集，那么该集上的唯一字符串是  $\varepsilon$ ，也就是 $\Sigma =  \left \{ \right \}$ 对应的 $\Sigma^* =  \left \{ \varepsilon \right \}$ 。空集可以简写为 $\phi$ 。

对于非空集 $\Sigma \ne \phi$ 它的符号串全体集 $\Sigma^*$ 是一个无穷集，因为 $n$ 的取值无上限。

假设 $U$ $V$ 是 $\Sigma$ 的两个子集。 （没有说是有限子集还是无线子集）。


### 上下文无关文法

文法，就是规则。
上下文无关文法，就是只需要看写的内容是不是符合这个规则。不需要管上下文。

一个上下文无关文法 $G$ 包括四个部分：一组终结符号、一组非终结符号、一个开始符号、一组产生式。

终结符号，**不能再分**的单元，token。有很多种类：关键字、标识符、字面量、运算符、界限符。

非终结符号，算术表达式、布尔表达式、赋值语句、函数等。总之不是终结符号那样的不可再分的东西，并且一个非终结符号代表一个特定的语法概念。（？抽象）。
可以理解为要被拆分为终结符号来理解的组合内容。

开始符号，是 **一个** 特殊的非终结符号。

产生式（也叫规则）

产生式的形式：
$A \to \alpha $ 左边的称为左部，右边的称为右部。

箭头左边 $A$ 是一个非终结符，箭头右边的 $\alpha$ 是由终结符号（或|与）非终结符号组成的符号串。

箭头右边，可以是一个终结符号、也可以是多个非终结符号的组合、也可以是终结符号和非终结符号的组合。

变量是一个算术表达式、算术表达式之间的四则运算也是算是表达式。


$ E \to i$ 。

其中 $i$ 表示变量；左部是非终结符，右部是终结符号。

$ E \to E + E$ 。

右部是非终结符号(E)与终结符号(+)的组合。

$ E \to E - E$ 。

右部是非终结符号(E)与终结符号(-)的组合。

$ E \to E * E$ 。

右部是非终结符号(E)与终结符号(*)的组合。

$ E \to E / E$ 。

右部是非终结符号(E)与终结符号(/)的组合。

$ E \to \left( E \right)$  

右部非终结符(E)与终结符号括号“（”,“）”的组合。

表达式的后面几个都是递归的。

一个上下文无关文法，可以表示为一个四元式 
$\left(V_t, V_n,S,\Psi\right)$ 。
$V_t$ 是非空有限集，是终结符号。终结符号必须非空。
$V_n$是非空有限集，每个元素都是非终结符号，$V_t \bigcap V_n = \phi$ 。
$S$ 是非终结符号，开始符号。
$\Psi$ 是产生式集合，是有限集合，对应了规则。每个产生式的形式都是 $P \to \alpha$ ，其中，$P \in V_n$ ， $\alpha \in \left(V_t \bigcup V_n\right)^*$，开始符号 $S$ 必须在某个产生式的左边出现一次。

若干个左部相同的产生式，可以合并为一个。

$P \to \alpha_1$

$P \to \alpha_2$

$P \to \alpha_3$

可以合并，表示或，任意一个都可以

$P \to \alpha_1\mid \alpha_2 \mid \alpha_3 $

大写字母表示非终结符，小写字母表示终结符，希腊字母表示终结符和非终结符组成的符号串。

推导、句型、语言。

符号约定，一般大写英文字母 $ABC...$ 代表非终结符，小写英文字母 $abc...$ 代表终结符，希腊字母 $\alpha \beta \gamma...$代表终结符和非终结符组成的字符串。

从一个文法 $G$ 的开始符号 $S$ 出发，可以推导出很多句型，只含有终结符的句型就是句子，文法 $G$ 产生的所有句子的全体组成一个语言 $L(G)$ 。

到了这里你是否觉得学习了一堆枯燥的概念，不要着急，到目前为止只需要知道以下几件事：
1. 文法是通过一条条地规则来书写的，我们需要能看懂这些规则。
2. 进行语法分析的时候需要对比这些规则。